"use strict";(self.webpackChunkfinance_dashboard=self.webpackChunkfinance_dashboard||[]).push([[291],{923:(e,t,a)=>{a.d(t,{An:()=>i,Kf:()=>d,Qw:()=>h,Vp:()=>c,au:()=>n,om:()=>o,pC:()=>s,vp:()=>l});var r=a(63204);const o=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenueByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}},s=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenue,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},n=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheet,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},l=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheetByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Balance Sheet By Month:",t),t}},i=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.getCOA,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},d=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},h=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.log("Error Create COA",t),[]}}},11291:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});var r=a(29490),o=a(89379),s=a(7353),n=a(19252),l=a(94496),i=a(65043),c=a(60446),d=a.n(c),h=a(56813),p=a(57488),u=a(923),x=a(39098),m=a(75139),g=a(80045),v=a(34535),y=a(26240),f=a(79958),b=a(12110),w=a(79328),A=a.n(w);var j=a(34677),k=a.n(j),C=a(31546);var R=a(22019),S=a(90761);const E=(0,v.Ay)(R.A)((e=>{let{theme:t}=e;return{"& .apexcharts-canvas":{"& .apexcharts-tooltip":(0,o.A)((0,o.A)({},(0,S.Vz)({color:t.palette.background.default})),{},{color:t.palette.text.primary,boxShadow:t.customShadows.dropdown,borderRadius:1.25*t.shape.borderRadius,"&.apexcharts-theme-light":(0,o.A)({borderColor:"transparent"},(0,S.Vz)({color:t.palette.background.default}))}),"& .apexcharts-xaxistooltip":(0,o.A)((0,o.A)({},(0,S.Vz)({color:t.palette.background.default})),{},{borderColor:"transparent",color:t.palette.text.primary,boxShadow:t.customShadows.dropdown,borderRadius:1.25*t.shape.borderRadius,"&:before":{borderBottomColor:(0,C.X4)(t.palette.grey[500],.24)},"&:after":{borderBottomColor:(0,C.X4)(t.palette.background.default,.8)}}),"& .apexcharts-tooltip-title":{textAlign:"center",fontWeight:t.typography.fontWeightBold,backgroundColor:(0,C.X4)(t.palette.grey[500],.08),color:t.palette.text["light"===t.palette.mode?"secondary":"primary"]},"& .apexcharts-legend":{padding:0},"& .apexcharts-legend-series":{display:"inline-flex !important",alignItems:"center"},"& .apexcharts-legend-marker":{marginRight:8},"& .apexcharts-legend-text":{lineHeight:"18px",textTransform:"capitalize"}}}})),I=(0,i.memo)(E);var z=a(70579);const F=["title","subheader","chart"],W=(0,v.Ay)(I)((e=>{let{theme:t}=e;return{height:400,"& .apexcharts-canvas, .apexcharts-inner, svg, foreignObject":{height:"100% !important"},"& .apexcharts-legend":{height:80,borderTop:"dashed 1px ".concat(t.palette.divider),top:"calc(".concat(320,"px) !important")}}}));function B(e){let{title:t,subheader:a,chart:r}=e,s=(0,g.A)(e,F);const n=(0,y.A)(),{colors:l,series:i,options:c}=r,d=null===i||void 0===i?void 0:i.map((e=>e.value)),h=function(e){const t=(0,y.A)(),a={show:!0,label:"Total",color:t.palette.text.secondary,fontSize:t.typography.subtitle2.fontSize,fontWeight:t.typography.subtitle2.fontWeight,lineHeight:t.typography.subtitle2.lineHeight},r={offsetY:8,color:t.palette.text.primary,fontSize:t.typography.h3.fontSize,fontWeight:t.typography.h3.fontWeight,lineHeight:t.typography.h3.lineHeight},o={colors:[t.palette.primary.main,t.palette.warning.main,t.palette.info.main,t.palette.error.main,t.palette.success.main,t.palette.warning.dark,t.palette.success.darker,t.palette.info.dark,t.palette.info.darker],chart:{toolbar:{show:!1},zoom:{enabled:!1},foreColor:t.palette.text.disabled,fontFamily:t.typography.fontFamily},states:{hover:{filter:{type:"lighten",value:.04}},active:{filter:{type:"darken",value:.88}}},fill:{opacity:1,gradient:{type:"vertical",shadeIntensity:0,opacityFrom:.4,opacityTo:0,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{width:3,curve:"smooth",lineCap:"round"},grid:{strokeDashArray:3,borderColor:t.palette.divider,xaxis:{lines:{show:!1}}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1}},markers:{size:0,strokeColors:t.palette.background.paper},tooltip:{theme:!1,x:{show:!0}},legend:{show:!0,fontSize:13,position:"top",horizontalAlign:"right",markers:{radius:12},fontWeight:500,itemMargin:{horizontal:8},labels:{colors:t.palette.text.primary}},plotOptions:{bar:{borderRadius:4,columnWidth:"28%",borderRadiusApplication:"end",borderRadiusWhenStacked:"last"},pie:{donut:{labels:{show:!0,value:r,total:a}}},radialBar:{track:{strokeWidth:"100%",background:(0,C.X4)(t.palette.grey[500],.16)},dataLabels:{value:r,total:a}},radar:{polygons:{fill:{colors:["transparent"]},strokeColors:t.palette.divider,connectorColors:t.palette.divider}},polarArea:{rings:{strokeColor:t.palette.divider},spokes:{connectorColors:t.palette.divider}}},responsive:[{breakpoint:t.breakpoints.values.sm,options:{plotOptions:{bar:{columnWidth:"40%"}}}},{breakpoint:t.breakpoints.values.md,options:{plotOptions:{bar:{columnWidth:"32%"}}}}]};return k()(o,e)}((0,o.A)({chart:{sparkline:{enabled:!0}},colors:l,labels:i.map((e=>e.name)),stroke:{colors:[n.palette.background.paper]},legend:{floating:!0,position:"bottom",horizontalAlign:"center"},dataLabels:{enabled:!0,dropShadow:{enabled:!1}},tooltip:{fillSeriesColor:!1,y:{formatter:e=>{return t=e,A()(t).format();var t},title:{formatter:e=>"".concat(e)}}},plotOptions:{pie:{donut:{labels:{show:!1}}}}},c));return(0,z.jsxs)(b.A,(0,o.A)((0,o.A)({},s),{},{children:[(0,z.jsx)(f.A,{title:t,subheader:a,sx:{mb:3}}),(0,z.jsx)(W,{dir:"ltr",type:"pie",series:d,options:h,height:280})]}))}var D=a(42796),T=a(94389),O=a(69516),P=a(69742),Z=a(26436),G=a(32870),H=a(94271);const L=[200,0,900,300,1200],M=["Page A","Page B","Page C","Page D","Page E"];function U(e){let{chart:t}=e;const[a,r]=(0,i.useState)({name:M,value:L}),[o,s]=(0,i.useState)({width:0,height:0}),n=(0,i.useRef)(null);return(0,i.useEffect)((()=>{const e={name:[],value:[]};Array.isArray(t)&&t.length>0&&(t.forEach((t=>{e.name.push(t.year.toString()),e.value.push(t.value)})),r(e))}),[t]),(0,i.useEffect)((()=>{const e=()=>{n.current&&s({width:n.current.offsetWidth,height:n.current.offsetHeight})};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,z.jsx)("div",{ref:n,style:{width:"100%",height:"100%"},children:o.width>0&&o.height>0&&(0,z.jsxs)(O.a,{height:o.height,width:o.width,xAxis:[{scaleType:"point",data:a.name}],series:[{type:"line",data:a.value}],sx:{["& .".concat(P.R9.root)]:{stroke:"#8884d8",strokeWidth:1},["& .".concat(Z.Gk.root)]:{stroke:"#8884d8",scale:"0.5",fill:"#fff",strokeWidth:2}},disableAxisListener:!0,children:[(0,z.jsx)(G.w,{}),(0,z.jsx)(H.l,{})]})})}const _=e=>{let{title:t,data:a}=e;const[r,o]=(0,i.useState)({value:0,rise:0,title:""});return(0,i.useEffect)((()=>{if(a&&a.length>0){const e={value:0,rise:0,title:""};e.title=t,a.forEach(((t,r)=>{e.value+=t.value,0===r&&(e.rise=t.value),r===a.length-1&&(e.rise=(100*(t.value-e.rise)/t.value).toPrecision(4))})),o(e)}}),[o,a,t]),(0,z.jsx)(b.A,{sx:{maxHeight:{xs:500,md:300}},children:(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,flexDirection:{xs:"column",md:"row"},maxHeight:{xs:450,md:250}},children:[(0,z.jsxs)(s.A,{sx:{width:{xs:"100%",md:"50%"},height:{xs:200,md:200}},padding:2,children:[(0,z.jsx)(l.A,{paddingBottom:1,children:t}),(0,z.jsxs)(s.A,{sx:{pt:2},children:[(0,z.jsx)(l.A,{fontSize:40,fontWeight:600,padding:1,children:r.value.toLocaleString()}),(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:{sm:"row"},pt:2},children:[(0,z.jsx)(s.A,{children:r.rise>=0?(0,z.jsx)(D.A,{color:"success"}):(0,z.jsx)(T.A,{color:"error"})}),(0,z.jsxs)(s.A,{sx:{m:1},children:[r.rise>=0?"+":"",r.rise,"%"]}),(0,z.jsx)(s.A,{children:(0,z.jsxs)(l.A,{color:"gray",children:[a.length," month"]})})]})]})]}),(0,z.jsx)(s.A,{sx:{width:{xs:"100%",md:"50%"},height:{xs:200,md:250}},children:(0,z.jsx)(U,{chart:a,width:"100%",height:"100%"})})]})})},N=(e,t)=>{const a={Revenue:[],Expense:[],TotalRevenue:[],NetIncome:[],GrossProfit:[],CashFlow:[],missedItem:[]},r=(e,t)=>{e.forEach((e=>{let r=!0;!0===t?(a.Revenue.map((t=>(e.name===t.name&&(t.value+=e.value,r=!1),!0))),!0===r&&a.Revenue.push(e)):(a.Expense.map((t=>(e.name===t.name&&(t.value+=e.value,r=!1),!0))),!0===r&&a.Expense.push(e))}))};return e.forEach((e=>{if(e.data.length>0&&Array.isArray(e.data)){const o=e.dateFlag,s=((e,t)=>{const a={revenue:[],expense:[]},r={revenue:0,cogs:0,sga:0,amorization:0,cashflow:0},o=[];return e.forEach((e=>{let s=!1;t.map((t=>(t[0].toString()===e[0]&&(((e,t,a,r)=>{const o=e,s=e=>{let t=!1;e?(o.revenue.length>0&&o.revenue.forEach((e=>{e.name===a[3]&&(e.value+=a[2],t=!0)})),!1===t&&o.revenue.push({name:a[3],value:a[2]})):(o.expense.length>0&&o.expense.forEach((e=>{e.name===a[3]&&(e.value+=a[2],t=!0)})),!1===t&&o.expense.push({name:a[3],value:a[2]}))};if(r[0].toString()===a[0])switch(r[4]){case"Revenues":t.revenue+=a[2],e=s(!0);break;case"COGS/S&O":t.cogs+=a[2],e=s(!1);break;case"SGA":t.sga+=a[2],e=s(!1);break;case"Depreciation & Amortization":t.amorization+=a[2],e=s(!1);break;case"Cash & Equivalents":t.cashflow+=a[2]}})(a,r,e,t),s=!0),!0))),s||o.push(e)})),{monthly:a,eachItem:r,missItem:o}})([...e.data],t);s.missItem.length>0&&a.missedItem.push({item:s.missItem,month:o}),((e,t)=>{const{revenue:o,amorization:s,cogs:n,sga:l,cashflow:i}=e.eachItem,c=o,d=o-(l+s),h=o-n;a.TotalRevenue.push({year:t,value:c}),a.NetIncome.push({year:t,value:d}),a.GrossProfit.push({year:t,value:h}),a.CashFlow.push({year:t,value:i}),0===a.Revenue.length?a.Revenue.push(...e.monthly.revenue):r(e.monthly.revenue,!0),0===a.Expense.length?a.Expense.push(...e.monthly.expense):r(e.monthly.expense,!1)})(s,o)}else console.log("empty")})),a};function V(){var e,t,a,r,c,g;const v=(0,x.Mp)(),[y,f]=(0,i.useState)({Revenue:null,Expense:null,TotalRevenue:[],NetIncome:[],GrossProfit:[],CashFlow:[]}),[b,w]=(0,i.useState)([]),[A,j]=(0,i.useState)({from:null,to:null}),[k,C]=(0,i.useState)(null),{user:R}=(0,m.Z)(),S=(e,t)=>{let a;a=t?(0,o.A)((0,o.A)({},A),{},{from:e}):(0,o.A)((0,o.A)({},A),{},{to:e}),j(a)};return(0,i.useEffect)((()=>{(async()=>{try{if(null!==A.from&&null!==A.to){const e=100*d()(A.from).year()+d()(A.from).month(),t={from:e,to:100*d()(A.to).year()+d()(A.to).month()},a=1===R.role?{userId:R._id,date:t}:{userId:R.parent,date:t},r=[],o=await(0,u.om)(a);if("success"===o.type){p.oR.success("Revenue Successfully Upload!",{theme:"colored"});const e=o.data.data;e.sort(((e,t)=>e.dateFlag-t.dateFlag)),e.map((e=>(r.push({dateFlag:e.dateFlag,data:e.data}),!0))),C(null)}else p.oR.error("Revenue Upload Error",{theme:"colored"});const s=await(0,u.vp)(a);if("success"===s.type){p.oR.success("Balance Sheet Successfully Upload!",{theme:"colored"});const e=s.data.data;e.sort(((e,t)=>e.dateFlag-t.dateFlag)),e.map((e=>(r.map((t=>(t.dateFlag===e.dateFlag&&(t.data=[...t.data,...e.data]),!0))),!0)))}else p.oR.error("Balance Sheet Upload err",{theme:"colored"});const n=N(r,b);f(n)}}catch(e){C(e)}})()}),[A,R._id,R.parent,R.role,b]),(0,i.useEffect)((()=>{(async()=>{const e=1===R.role?{userId:R._id}:{userId:R.parent},t=await(0,u.An)(e);"success"===t.type?(p.oR.success("COA Successfully Upload!",{theme:"colored"}),w(t.data)):p.oR.error("COA Upload Error",{theme:"colored"})})()}),[R._id,R.parent,R.role]),(0,z.jsxs)(n.A,{maxWidth:!v.themeStretch&&"xl",children:[(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2,flexDirection:{xs:"column",sm:"row"}},children:[(0,z.jsx)(l.A,{variant:"h4",children:"\ud83d\udc4b Welcome to Dashboard"}),(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mr:4,border:"2px solid",borderColor:"#007867",borderRadius:1,p:.2},children:[(0,z.jsx)(h.l,{label:""===A.from?"From":"",views:["month","year"],value:A.from,onChange:e=>S(e,!0)}),(0,z.jsx)(s.A,{sx:{mx:1},children:"-"}),(0,z.jsx)(h.l,{label:""===A.to?"To":"",views:["month","year"],value:A.to,onChange:e=>S(e,!1)})]})]}),(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,flexDirection:{xs:"column",sm:"row"}},children:[(0,z.jsx)(s.A,{sx:{width:{xl:"50%",lg:"50%",xs:"95%"},p:1},children:(0,z.jsx)(_,{title:"Total Revenue",data:null!==(e=null===y||void 0===y?void 0:y.TotalRevenue)&&void 0!==e?e:[]})}),(0,z.jsx)(s.A,{sx:{width:{xl:"50%",lg:"50%",xs:"95%"},p:1},children:(0,z.jsx)(_,{title:"Cash Flow",data:null!==(t=null===y||void 0===y?void 0:y.CashFlow)&&void 0!==t?t:[]})})]}),(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,flexDirection:{xs:"column",sm:"row"}},children:[(0,z.jsx)(s.A,{sx:{width:{xl:"50%",lg:"50%",xs:"95%"},p:1},children:(0,z.jsx)(_,{title:"NetIncome",data:null!==(a=null===y||void 0===y?void 0:y.NetIncome)&&void 0!==a?a:[]})}),(0,z.jsx)(s.A,{sx:{width:{xl:"50%",lg:"50%",xs:"95%"},p:1},children:(0,z.jsx)(_,{title:"Gross Profit",data:null!==(r=null===y||void 0===y?void 0:y.GrossProfit)&&void 0!==r?r:[]})})]}),(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,flexDirection:{xs:"column",sm:"row"}},children:[(0,z.jsx)(s.A,{sx:{width:{xl:"50%",xs:"95%"},p:1},children:(0,z.jsx)(B,{title:"Revenue Distribtion",chart:{series:null!==(c=null===y||void 0===y?void 0:y.Revenue)&&void 0!==c?c:[{name:"a",value:1},{name:"b",value:1},{name:"c",value:1},{name:"d",value:1},{name:"e",value:1}]}})}),(0,z.jsx)(s.A,{sx:{width:{xl:"50%",xs:"95%"},p:1},children:(0,z.jsx)(B,{title:"Expense Distribtion",chart:{series:null!==(g=null===y||void 0===y?void 0:y.Cash)&&void 0!==g?g:[{name:"a",value:1},{name:"b",value:2},{name:"c",value:3},{name:"d",value:2}]}})})]}),k&&(0,z.jsx)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh",textAlign:"center"},children:(0,z.jsx)(l.A,{variant:"h5",sx:{pt:5},children:null===k||void 0===k?void 0:k.message})})]})}function X(){return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(r.mg,{children:(0,z.jsx)("title",{children:" Dashboard "})}),(0,z.jsx)(V,{})]})}}}]);
//# sourceMappingURL=291.635b6922.chunk.js.map