{"version":3,"file":"static/js/466.90ae54c0.chunk.js","mappings":"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","sources":["api/transaction.js","components/table/uploadFile.js","sections/DataUpload/coaUpload/view.js","pages/dataUpload/coaUpload.js","../node_modules/@mui/icons-material/esm/FileUpload.js"],"sourcesContent":["import axios, { endpoints } from 'src/utils/axios';\r\n\r\nexport const GetRevenueByMonth = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.revenue.getRevenueByMonth, data)\r\n            .then(res => {result = {type: 'success', data: res.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result;\r\n  } catch (error) {\r\n    console.error(\r\n      'Error fetching Revenue By Month:', error\r\n    );\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const GetRevenue = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.revenue.getRevenue, data)\r\n            .then(res => {result = {type: 'success', data: res.data.data.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result;\r\n  } catch (error) {\r\n    console.error(\r\n      'Error fetching Revenue:',error\r\n    );\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const GetBalanceSheet = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.balanceSheet.getBalanceSheet, data)\r\n            .then(res => {result = {type: 'success', data: res.data.data.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result;\r\n  } catch (error) {\r\n    console.error(\r\n      'Error fetching Revenue:',error\r\n    );\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const GetBalanceSheetByMonth = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.balanceSheet.getBalanceSheetByMonth, data)\r\n            .then(res => {result = {type: 'success', data: res.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result;\r\n  } catch (error) {\r\n    console.error(\r\n      'Error fetching Balance Sheet By Month:', error\r\n    );\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const GetCOA = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.coa.getCOA, data)\r\n            .then(res => {result = {type: 'success', data: res.data.data.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result\r\n  } catch (error) {\r\n    console.error(\r\n      'Error fetching Revenue:',error\r\n    );\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const CreateRevenue = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.revenue.create, data)\r\n            .then(res => {result = {type: 'success', data: res.data.data.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result;\r\n  } catch (error) {\r\n    console.log(\"Error Create Revenue\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport const CreateBalanceSheet = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.balanceSheet.create, data)\r\n            .then(res => {result = {type: 'success', data: res.data.data.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result;\r\n  } catch (error) {\r\n    console.log(\"Error Create Revenue\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport const CreateCOA = async (data) => {\r\n  try {\r\n    let result = {type: '', data: {}}\r\n    await axios.post(endpoints.coa.create, data)\r\n            .then(res => {result = {type: 'success', data: res.data.data.data}})\r\n            .catch(err => {result = {type: 'error', data: err}})\r\n    return result;\r\n  } catch (error) {\r\n    console.log(\"Error Create COA\", error);\r\n    return [];\r\n  }\r\n}","import * as XLSX from 'xlsx';\r\nimport PropTypes from 'prop-types';\r\nimport React, { useEffect, useState } from 'react';\r\nimport {\r\n  Box,\r\n  Button,\r\n  Card,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  Typography,\r\n  TextField,\r\n  TablePagination,\r\n  TableSortLabel,\r\n  InputAdornment,\r\n  IconButton,\r\n} from '@mui/material';\r\n\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport { styled } from '@mui/material/styles';\r\nimport FileUploadIcon from '@mui/icons-material/FileUpload';\r\n\r\nconst VisuallyHiddenInput = styled('input')({\r\n  clip: 'rect(0 0 0 0)',\r\n  clipPath: 'inset(50%)',\r\n  height: 1,\r\n  overflow: 'hidden',\r\n  position: 'absolute',\r\n  bottom: 0,\r\n  left: 0,\r\n  whiteSpace: 'nowrap',\r\n  width: 1,\r\n});\r\n\r\nfunction UploadFile ({onSetResult, currentResult, titleArray}) {\r\n  const [tableData, setTableData] = useState([]);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [tempQuery, setTempQuery] = useState('');\r\n  const [orderBy, setOrderBy] = useState('');\r\n  const [orderDirection, setOrderDirection] = useState('asc');\r\n  const [page, setPage] = useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = useState(7);\r\n  \r\n  const formatRow = (row) => {\r\n    const tempData = []\r\n    // filter empty row\r\n    const filteredRow = row.filter(item => item.length !== 0)\r\n    // format row\r\n    filteredRow.map(item => {\r\n      const tempItem = [...item];\r\n      if(typeof(item[0]) !== 'string') tempItem[0] = tempItem[0].toString();\r\n      // when transactin upload, item[1] is vendor/revenue Id field, item[2] is amount field\r\n      if(titleArray[2] !== 'Roll UP') {\r\n        if(item[1] && item[3]) {\r\n          if(typeof(item[1]) !== 'string') tempItem[1] = tempItem[1].toString();\r\n          if(typeof(item[3]) !== 'string') tempItem[3] = tempItem[3].toString();\r\n        } else {\r\n          tempItem[1] = '';\r\n          tempItem[3] = '';\r\n        }\r\n      } \r\n      tempData.push(tempItem)\r\n      return true;\r\n    })\r\n    return tempData;\r\n  }\r\n\r\n  const handleFileUpload = (event) => {\r\n    const file = event.target.files[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        const data = new Uint8Array(e.target.result);\r\n        const workbook = XLSX.read(data, { type: 'array' });\r\n\r\n        // Assuming the first sheet is what we want\r\n        const sheetName = workbook.SheetNames[0];\r\n        const worksheet = workbook.Sheets[sheetName];\r\n        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\r\n\r\n        if (jsonData.length > 0) {\r\n          const rows = jsonData.slice(1);\r\n          const tempRow = formatRow(rows);\r\n          onSetResult(tempRow);\r\n        }\r\n      };\r\n      reader.readAsArrayBuffer(file);\r\n    }\r\n  }\r\n\r\n  const handleSearchChange = (event) => {\r\n    setTempQuery(event.target.value);\r\n  };\r\n\r\n  const handleRequestSort = (column) => {\r\n    const isAsc = orderBy === column && orderDirection === 'asc';\r\n    setOrderDirection(isAsc ? 'desc' : 'asc');\r\n    setOrderBy(column);\r\n  };\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  const sortedData = [...tableData].sort((a, b) => {\r\n    if (!orderBy) return 0;\r\n    const columnIndex = titleArray.indexOf(orderBy);\r\n    if (a[columnIndex] < b[columnIndex]) {\r\n      return orderDirection === 'asc' ? -1 : 1;\r\n    }\r\n    if (a[columnIndex] > b[columnIndex]) {\r\n      return orderDirection === 'asc' ? 1 : -1;\r\n    }\r\n    return 0;\r\n  });\r\n\r\n  const handleSearch = () => {\r\n    setSearchQuery(tempQuery);\r\n  }\r\n  const filteredData = sortedData.filter((row) => row[0]?.toString().includes(searchQuery));\r\n  \r\n\r\n  const paginatedData = filteredData.slice(\r\n    page * rowsPerPage,\r\n    page * rowsPerPage + rowsPerPage\r\n  );\r\n\r\n  useEffect(() => {\r\n    setTableData(currentResult)\r\n  },[currentResult])\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        position: 'relative',\r\n        width: '100%',\r\n        justifyContent: 'top',\r\n        alignItems: 'center',\r\n      }}\r\n    >\r\n      <Card sx={{ \r\n        width: '100%', \r\n        p: 2,\r\n      }}>\r\n        <Typography sx={{ fontWeight: '500', fontSize: '18px' }}>\r\n          {titleArray[2] === 'Roll UP' ? \"Chart of Account\" : \"Monthly Result\"} Table\r\n        </Typography>\r\n        <Box\r\n          sx={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            mt: 2,\r\n            mb: 2\r\n          }}\r\n        >\r\n          <TextField\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            value={tempQuery}\r\n            onChange={handleSearchChange}\r\n            placeholder=\"Search by AccountID\"\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    edge=\"end\"\r\n                    color=\"primary\"\r\n                    onClick={handleSearch} // Replace with your search logic\r\n                  >\r\n                    <SearchIcon />\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              ),\r\n            }}\r\n            sx={{ width: '40%' }}\r\n          />\r\n          <Button\r\n            component=\"label\"\r\n            color=\"primary\"\r\n            variant=\"contained\"\r\n            startIcon={<FileUploadIcon />}\r\n          >\r\n            Upload files\r\n            <VisuallyHiddenInput\r\n              type=\"file\"\r\n              accept=\".xlsx\"\r\n              onChange={(event) => handleFileUpload(event)}\r\n              multiple={false}\r\n            />\r\n          </Button>\r\n        </Box>\r\n\r\n        <TableContainer>\r\n          <Table>\r\n            <TableHead>\r\n              <TableRow>\r\n                {titleArray.map((title, index) => (\r\n                  <TableCell key={index} style={{ textAlign: 'center' }}>\r\n                    <TableSortLabel\r\n                      active={orderBy === title}\r\n                      direction={orderBy === title ? orderDirection : 'asc'}\r\n                      onClick={() => handleRequestSort(title)}\r\n                    >\r\n                      {title}\r\n                    </TableSortLabel>\r\n                  </TableCell>\r\n                ))}\r\n              </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n              {paginatedData.map((row, rowIndex) => (\r\n                <TableRow key={rowIndex}>\r\n                  {row.map((cell, cellIndex) => (\r\n                    <TableCell\r\n                      key={cellIndex}\r\n                      style={{\r\n                        padding: '20px',\r\n                        textAlign: 'center',\r\n                      }}\r\n                    >\r\n                      {cell}\r\n                    </TableCell>\r\n                  ))}\r\n                </TableRow>\r\n              ))}\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n\r\n        <TablePagination\r\n          rowsPerPageOptions={[7, 15, 20]}\r\n          component=\"div\"\r\n          count={filteredData.length}\r\n          rowsPerPage={rowsPerPage}\r\n          page={page}\r\n          onPageChange={handleChangePage}\r\n          onRowsPerPageChange={handleChangeRowsPerPage}\r\n        />\r\n      </Card>\r\n    </Box>\r\n  );\r\n}\r\n\r\nUploadFile.propTypes = {\r\n  currentResult: PropTypes.array,\r\n  titleArray: PropTypes.array,\r\n  onSetResult: PropTypes.func,\r\n};\r\n\r\nexport default UploadFile;\r\n","import { useEffect, useState } from 'react';\r\nimport {Container, Typography} from '@mui/material';\r\nimport {LoadingButton} from '@mui/lab';\r\n// eslint-disable-next-line import/no-extraneous-dependencies\r\nimport {toast } from 'react-toastify';\r\n// eslint-disable-next-line import/no-extraneous-dependencies\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport CloudUploadIcon from '@mui/icons-material/CloudUpload';\r\nimport { CreateCOA, GetCOA } from 'src/api/transaction';\r\nimport { useSettingsContext } from 'src/components/settings';\r\nimport { useAuthContext } from 'src/auth/hooks';\r\nimport UploadFile from 'src/components/table/uploadFile';\r\nimport './style.css';\r\n\r\nconst COATitle = [\r\n  \"AccountID\", \"Description\", \"Roll UP\", \"IS/BS\"\r\n]\r\n\r\nexport default function CoaUpload() {\r\n  const settings = useSettingsContext();\r\n  const {user} = useAuthContext();\r\n  const [COAResult, setCOAResult] = useState([]);\r\n  const [uploadCOA, setUploadCOA] = useState(false);\r\n\r\n  const handleSetCOAResult = (value) => {\r\n    setCOAResult(value)\r\n  }\r\n\r\n  const onCOASubmit = async () => {\r\n    setUploadCOA(true)\r\n    // add empty string for standard category\r\n    const tempResult = JSON.parse(JSON.stringify(COAResult));\r\n    tempResult.map(coa => {\r\n      coa.push('');\r\n      return true;\r\n    })\r\n\r\n    console.log(user.parent, user.role)\r\n    const data = user.role === 1 ? \r\n      {\r\n        userId: user._id,\r\n        data: tempResult\r\n      } :\r\n      {\r\n        userId: user.parent,\r\n        data: tempResult\r\n      } \r\n    if(!data.data || data.data.length === 0) {\r\n      toast.error('COA data required!',{theme: \"colored\"})\r\n      setUploadCOA(false)\r\n    } else {\r\n      const response = await CreateCOA(data)\r\n      if(response.type === \"success\") {\r\n        toast.success('COA Successfully Uploaded',{theme: \"colored\"})\r\n      }else {\r\n        toast.error('COA Upload Error',{theme: \"colored\"})\r\n      }\r\n\r\n      // remove standard category\r\n      const tempRes = response.data.map((res) => {\r\n        res.pop();\r\n        return res;\r\n      })\r\n      setCOAResult(tempRes)\r\n      setUploadCOA(false)\r\n    }\r\n  }\r\n\r\n  useEffect(()=>{\r\n    const getCOA = async () => {\r\n      const data = user.role === 1 ? {userId: user._id} : {userId: user.parent}\r\n      const response = await GetCOA(data)\r\n      if(response.type === \"success\") {\r\n        toast.success(\"COA Successfully Upload!\",{theme: \"colored\"});\r\n        // remove standard category\r\n        const tempRes = response.data.map((res) => {\r\n          res.pop();\r\n          return res;\r\n        })\r\n        setCOAResult(tempRes);\r\n      }else {\r\n        toast.error('COA Upload Error', {theme: \"colored\"})\r\n      }\r\n    }\r\n\r\n    getCOA()\r\n  },[user._id, user.parent, user.role])\r\n  \r\n  return (\r\n    <Container maxWidth={settings.themeStretch ? false : 'xl'}>\r\n      <Typography variant=\"h4\" sx={{mb:2}}> Upload Chart of Account </Typography>\r\n      <UploadFile onSetResult={handleSetCOAResult} currentResult={COAResult} titleArray={COATitle}/>\r\n      <LoadingButton\r\n        component=\"label\"\r\n        color=\"primary\"\r\n        variant=\"contained\"\r\n        onClick={onCOASubmit}\r\n        loading={uploadCOA}\r\n        sx = {{mt:2, mb:2}}\r\n        startIcon={<CloudUploadIcon />}\r\n      >\r\n        Submit\r\n      </LoadingButton>\r\n    </Container>\r\n  );\r\n}\r\n","import { Helmet } from 'react-helmet-async';\r\nimport CoaUpload from 'src/sections/DataUpload/coaUpload/view';\r\n\r\nexport default function Page() {\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title> Dashboard: COA Upload</title>\r\n      </Helmet>\r\n\r\n      <CoaUpload />\r\n    </>\r\n  );\r\n}\r\n","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z\"\n}), 'FileUpload');"],"names":["GetRevenueByMonth","async","result","type","data","axios","post","endpoints","revenue","getRevenueByMonth","then","res","catch","err","error","console","GetRevenue","getRevenue","GetBalanceSheet","balanceSheet","getBalanceSheet","GetBalanceSheetByMonth","getBalanceSheetByMonth","GetCOA","coa","getCOA","CreateRevenue","create","log","CreateBalanceSheet","CreateCOA","VisuallyHiddenInput","styled","clip","clipPath","height","overflow","position","bottom","left","whiteSpace","width","_ref","onSetResult","currentResult","titleArray","tableData","setTableData","useState","searchQuery","setSearchQuery","tempQuery","setTempQuery","orderBy","setOrderBy","orderDirection","setOrderDirection","page","setPage","rowsPerPage","setRowsPerPage","handleFileUpload","event","file","target","files","reader","FileReader","onload","e","Uint8Array","workbook","XLSX","sheetName","SheetNames","worksheet","Sheets","jsonData","sheet_to_json","header","length","tempRow","row","tempData","filter","item","map","tempItem","toString","push","formatRow","slice","readAsArrayBuffer","filteredData","sort","a","b","columnIndex","indexOf","_row$","includes","paginatedData","useEffect","_jsx","Box","sx","display","flexDirection","justifyContent","alignItems","children","_jsxs","Card","p","Typography","fontWeight","fontSize","mt","mb","TextField","variant","size","value","onChange","placeholder","InputProps","endAdornment","InputAdornment","IconButton","edge","color","onClick","handleSearch","SearchIcon","Button","component","startIcon","FileUploadIcon","accept","multiple","TableContainer","Table","TableHead","TableRow","title","index","TableCell","style","textAlign","TableSortLabel","active","direction","handleRequestSort","column","TableBody","rowIndex","cell","cellIndex","padding","TablePagination","rowsPerPageOptions","count","onPageChange","handleChangePage","newPage","onRowsPerPageChange","parseInt","COATitle","CoaUpload","settings","useSettingsContext","user","useAuthContext","COAResult","setCOAResult","uploadCOA","setUploadCOA","role","userId","_id","parent","response","toast","success","theme","tempRes","pop","Container","maxWidth","themeStretch","UploadFile","LoadingButton","tempResult","JSON","parse","stringify","loading","CloudUploadIcon","Page","_Fragment","Helmet","createSvgIcon","d"],"sourceRoot":""}